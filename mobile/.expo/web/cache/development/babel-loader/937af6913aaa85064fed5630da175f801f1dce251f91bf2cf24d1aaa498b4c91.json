{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState } from 'react';\nimport { useNavigation, useRoute } from '@react-navigation/native';\nimport { Container, Form, Logo, Subtitle, Title, TitleDiv } from \"./styles\";\nimport Makeyourgologo from \"../../../assets/makeyourgo.svg\";\nimport { Input } from \"../../../components/Input\";\nimport { Button } from \"../../../components/Button\";\nimport { api } from \"../../../services/api\";\nimport * as Yup from 'yup';\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport { InputPassword } from \"../../../components/InputPassword\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport function ForgotPasswordSecondStep() {\n  var _useState = useState(''),\n    _useState2 = _slicedToArray(_useState, 2),\n    token = _useState2[0],\n    setToken = _useState2[1];\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    password = _useState4[0],\n    setPassword = _useState4[1];\n  var _useState5 = useState(''),\n    _useState6 = _slicedToArray(_useState5, 2),\n    passwordConfirm = _useState6[0],\n    setPasswordConfirm = _useState6[1];\n  var _useState7 = useState(false),\n    _useState8 = _slicedToArray(_useState7, 2),\n    isDisabled = _useState8[0],\n    setIsDisabled = _useState8[1];\n  var navigation = useNavigation();\n  var route = useRoute();\n  var _ref = route.params,\n    data = _ref.data;\n  function handleNextStep() {\n    var schema, email, tokenNumber, newData;\n    return _regeneratorRuntime.async(function handleNextStep$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setIsDisabled(true);\n            _context.prev = 1;\n            schema = Yup.object().shape({\n              email: Yup.string().email('E-mail inválido').required('E-mail é obrigatório'),\n              password: Yup.string().required('Senha é obrigatório'),\n              passwordConfirm: Yup.string().required('Confirmação de Senha é obrigatório')\n            });\n            email = data.email;\n            tokenNumber = Number(token);\n            newData = {\n              email: email,\n              tokenNumber: tokenNumber,\n              password: password,\n              passwordConfirm: passwordConfirm\n            };\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(schema.validate(newData));\n          case 8:\n            if (!(password !== passwordConfirm)) {\n              _context.next = 11;\n              break;\n            }\n            setIsDisabled(false);\n            return _context.abrupt(\"return\", Alert.alert('Opa, as senhas nao conferem !'));\n          case 11:\n            _context.next = 13;\n            return _regeneratorRuntime.awrap(api.post('/users/reset_password', {\n              email: email,\n              token: tokenNumber,\n              senha: password\n            }).then(function () {\n              setIsDisabled(false);\n              navigation.navigate('Confirmation', {\n                nextScreenRoute: 'SignInPage',\n                title: 'Resenha Alterada !',\n                message: 'Agora é só fazer login\\ne aproveitar'\n              });\n            }));\n          case 13:\n            _context.next = 24;\n            break;\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](1);\n            if (!(_context.t0 instanceof Yup.ValidationError)) {\n              _context.next = 22;\n              break;\n            }\n            setIsDisabled(false);\n            return _context.abrupt(\"return\", Alert.alert('Opa', _context.t0.message));\n          case 22:\n            setIsDisabled(false);\n            return _context.abrupt(\"return\", Alert.alert('Opa, o token informado é invalido ou expirado !'));\n          case 24:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[1, 15]], Promise);\n  }\n  return _jsxs(Container, {\n    children: [_jsx(StatusBar, {\n      barStyle: \"light-content\",\n      backgroundColor: \"transparent\",\n      translucent: true\n    }), _jsx(Logo, {\n      children: _jsx(Makeyourgologo, {})\n    }), _jsxs(TitleDiv, {\n      children: [_jsx(Title, {\n        children: \"Token enviado\"\n      }), _jsxs(Subtitle, {\n        children: [\"Foi enviado um token de valida\\xE7\\xE3o \", '\\n', \"para seu email.\"]\n      })]\n    }), _jsxs(Form, {\n      children: [_jsx(Input, {\n        title: \"Token\",\n        onChangeText: setToken,\n        value: token\n      }), _jsx(InputPassword, {\n        title: \"Nova senha\",\n        onChangeText: setPassword,\n        value: password\n      }), _jsx(InputPassword, {\n        title: \"Confirme a senha\",\n        onChangeText: setPasswordConfirm,\n        value: passwordConfirm\n      }), _jsx(Button, {\n        title: \"Pesquisar\",\n        onPress: handleNextStep,\n        disabled: isDisabled\n      })]\n    })]\n  });\n}","map":{"version":3,"names":["React","useState","useNavigation","useRoute","Container","Form","Logo","Subtitle","Title","TitleDiv","Makeyourgologo","Input","Button","api","Yup","Alert","StatusBar","InputPassword","jsx","_jsx","jsxs","_jsxs","ForgotPasswordSecondStep","_useState","_useState2","_slicedToArray","token","setToken","_useState3","_useState4","password","setPassword","_useState5","_useState6","passwordConfirm","setPasswordConfirm","_useState7","_useState8","isDisabled","setIsDisabled","navigation","route","_ref","params","data","handleNextStep","schema","email","tokenNumber","newData","_regeneratorRuntime","async","handleNextStep$","_context","prev","next","object","shape","string","required","Number","awrap","validate","abrupt","alert","post","senha","then","navigate","nextScreenRoute","title","message","t0","ValidationError","stop","Promise","children","barStyle","backgroundColor","translucent","onChangeText","value","onPress","disabled"],"sources":["C:/Users/Guilherme/Documents/MakeYourGO/mobile/src/pages/ForgotPasswordPage/ForgotPasswordSecondStep/index.tsx"],"sourcesContent":["/* eslint-disable space-before-function-paren */\r\nimport React, { useState } from 'react';\r\nimport { useNavigation, useRoute } from '@react-navigation/native';\r\nimport { Container, Form, Logo, Subtitle, Title, TitleDiv } from './styles';\r\nimport Makeyourgologo from '../../../assets/makeyourgo.svg';\r\nimport { Input } from '../../../components/Input';\r\nimport { Button } from '../../../components/Button';\r\n\r\nimport { api } from '../../../services/api';\r\nimport * as Yup from 'yup';\r\n\r\nimport { Alert, StatusBar } from 'react-native';\r\nimport { InputPassword } from '../../../components/InputPassword';\r\n\r\ninterface Params {\r\n  data: { email: string };\r\n}\r\n\r\nexport function ForgotPasswordSecondStep() {\r\n  const [token, setToken] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [passwordConfirm, setPasswordConfirm] = useState('');\r\n  const [isDisabled, setIsDisabled] = useState(false);\r\n\r\n  const navigation = useNavigation();\r\n\r\n  const route = useRoute();\r\n  const { data } = route.params as Params;\r\n\r\n  async function handleNextStep() {\r\n    setIsDisabled(true);\r\n\r\n    try {\r\n      const schema = Yup.object().shape({\r\n        email: Yup.string()\r\n          .email('E-mail inválido')\r\n          .required('E-mail é obrigatório'),\r\n        password: Yup.string().required('Senha é obrigatório'),\r\n        passwordConfirm: Yup.string().required(\r\n          'Confirmação de Senha é obrigatório'\r\n        )\r\n      });\r\n\r\n      const { email } = data;\r\n\r\n      const tokenNumber = Number(token);\r\n\r\n      const newData = {\r\n        email,\r\n        tokenNumber,\r\n        password,\r\n        passwordConfirm\r\n      };\r\n\r\n      await schema.validate(newData);\r\n\r\n      if (password !== passwordConfirm) {\r\n        setIsDisabled(false);\r\n        return Alert.alert('Opa, as senhas nao conferem !');\r\n      }\r\n\r\n      await api\r\n        .post('/users/reset_password', {\r\n          email,\r\n          token: tokenNumber,\r\n          senha: password\r\n        })\r\n        .then(() => {\r\n          setIsDisabled(false);\r\n          navigation.navigate('Confirmation', {\r\n            nextScreenRoute: 'SignInPage',\r\n            title: 'Resenha Alterada !',\r\n            message: 'Agora é só fazer login\\ne aproveitar'\r\n          });\r\n        });\r\n    } catch (error) {\r\n      if (error instanceof Yup.ValidationError) {\r\n        setIsDisabled(false);\r\n        return Alert.alert('Opa', error.message);\r\n      } else {\r\n        setIsDisabled(false);\r\n        return Alert.alert('Opa, o token informado é invalido ou expirado !');\r\n      }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      <StatusBar\r\n        barStyle=\"light-content\"\r\n        backgroundColor=\"transparent\"\r\n        translucent\r\n      />\r\n      <Logo>\r\n        <Makeyourgologo />\r\n      </Logo>\r\n\r\n      <TitleDiv>\r\n        <Title>Token enviado</Title>\r\n\r\n        <Subtitle>\r\n          Foi enviado um token de validação {'\\n'}para seu email.\r\n        </Subtitle>\r\n      </TitleDiv>\r\n      <Form>\r\n        <Input title=\"Token\" onChangeText={setToken} value={token} />\r\n        <InputPassword\r\n          title=\"Nova senha\"\r\n          onChangeText={setPassword}\r\n          value={password}\r\n        />\r\n        <InputPassword\r\n          title=\"Confirme a senha\"\r\n          onChangeText={setPasswordConfirm}\r\n          value={passwordConfirm}\r\n        />\r\n\r\n        <Button\r\n          title=\"Pesquisar\"\r\n          onPress={handleNextStep}\r\n          disabled={isDisabled}\r\n        />\r\n      </Form>\r\n    </Container>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}